# Migration `20200601161803-create`

This migration has been generated by Matej Hrescak at 6/1/2020, 4:18:03 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Post" (
"authorId" integer   ,"content" text   ,"id" SERIAL,"published" boolean  NOT NULL DEFAULT false,"title" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."User" (
"email" text  NOT NULL ,"id" SERIAL,"name" text   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Kitchen" (
"description" text  NOT NULL ,"id" SERIAL,"name" text  NOT NULL ,"ownerId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Recipe" (
"cookDuration" integer  NOT NULL ,"id" SERIAL,"imageURL" text  NOT NULL ,"ingredientSections" text []  ,"instructions" text  NOT NULL ,"isDeleted" boolean  NOT NULL DEFAULT false,"kitchenId" integer  NOT NULL ,"name" text  NOT NULL ,"prepDuration" integer  NOT NULL ,"publicID" text  NOT NULL ,"servings" integer  NOT NULL ,"sourceName" text  NOT NULL ,"sourceURL" text  NOT NULL ,"summary" text  NOT NULL ,"totalDuration" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."RecipeIngredient" (
"id" SERIAL,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Category" (
"id" SERIAL,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_KitchenToUser" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE TABLE "public"."_RecipeToUser" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "Kitchen_ownerId" ON "public"."Kitchen"("ownerId")

CREATE UNIQUE INDEX "Recipe.publicID" ON "public"."Recipe"("publicID")

CREATE UNIQUE INDEX "_KitchenToUser_AB_unique" ON "public"."_KitchenToUser"("A","B")

CREATE  INDEX "_KitchenToUser_B_index" ON "public"."_KitchenToUser"("B")

CREATE UNIQUE INDEX "_RecipeToUser_AB_unique" ON "public"."_RecipeToUser"("A","B")

CREATE  INDEX "_RecipeToUser_B_index" ON "public"."_RecipeToUser"("B")

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Kitchen" ADD FOREIGN KEY ("ownerId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Recipe" ADD FOREIGN KEY ("kitchenId")REFERENCES "public"."Kitchen"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_KitchenToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Kitchen"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_KitchenToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_RecipeToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Recipe"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_RecipeToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200601161803-create
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,69 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+model Post {
+  id        Int     @default(autoincrement()) @id
+  title     String
+  content   String?
+  published Boolean @default(false)
+  author    User?   @relation(fields: [authorId], references: [id])
+  authorId  Int?
+}
+
+model User {
+  id             Int       @default(autoincrement()) @id
+  email          String    @unique
+  name           String?
+  posts          Post[]
+  ownKitchen     Kitchen   @relation("KitchenOwnership")
+  kitchens       Kitchen[] @relation(references: [id])
+  starredRecipes Recipe[]
+}
+
+model Kitchen {
+  id          Int      @default(autoincrement()) @id
+  name        String
+  description String
+  owner       User     @relation("KitchenOwnership", references: [id], fields: [ownerId])
+  ownerId     Int
+  users       User[]   @relation(references: [id])
+  recipes     Recipe[]
+}
+
+model Recipe {
+  id                 Int      @default(autoincrement()) @id
+  name               String
+  summary            String
+  publicID           String   @unique
+  sourceName         String
+  sourceURL          String
+  servings           Int
+  prepDuration       Int
+  cookDuration       Int
+  totalDuration      Int
+  kitchen            Kitchen  @relation(references: [id], fields: [kitchenId])
+  kitchenId          Int
+  imageURL           String
+  //ingredients  RecipeIngredient[]
+  ingredientSections String[]
+  instructions       String
+  isDeleted          Boolean  @default(value: false)
+  //categories   Category[] @relation(references: [id])
+  starredBy          User[]
+
+}
+
+model RecipeIngredient {
+  id Int @default(autoincrement()) @id
+
+}
+
+model Category {
+  id Int @default(autoincrement()) @id
+}
```


